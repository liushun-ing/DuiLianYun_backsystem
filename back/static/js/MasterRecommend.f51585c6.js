(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["MasterRecommend"],{"3d04":function(e,t,r){},"58c3":function(e,t,r){"use strict";r("3d04")},d1c2:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"crumbs"},[r("el-breadcrumb",{attrs:{separator:"/"}},[r("el-breadcrumb-item",[r("i",{staticClass:"el-icon-lx-cascades"}),e._v(" 楹联家推荐管理\n            ")])],1)],1),r("div",{staticClass:"container"},[r("div",{staticClass:"handle-box"},[r("el-input",{staticClass:"handle-input mr10",attrs:{placeholder:"楹联家名字"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch(t)}},model:{value:e.inputKey,callback:function(t){e.inputKey=t},expression:"inputKey"}}),r("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:e.handleRefresh}},[e._v("刷新")]),r("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleSearch}},[e._v("搜索")])],1),r("el-table",{ref:"multipleTable",staticClass:"table",attrs:{data:e.masterList,border:"","header-cell-class-name":"table-header"}},[r("el-table-column",{attrs:{prop:"masterName","min-width":"150",label:"楹联家名字",align:"center"}}),r("el-table-column",{attrs:{label:"头像(查看大图)","min-width":"140",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[r("el-image",{staticClass:"table-td-thumb",attrs:{src:e.row.masterPhoto,"preview-src-list":[e.row.masterPhoto]}})]}}])}),r("el-table-column",{attrs:{label:"简介",align:"center","min-width":"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",{staticClass:"master_wrap"},[e._v(e._s(t.row.masterIntroduction))])]}}])}),r("el-table-column",{attrs:{prop:"masterRecommendStartDate",width:"160",label:"推荐开始时间",align:"center",sortable:""}}),r("el-table-column",{attrs:{prop:"masterRecommendEndDate",width:"160",label:"推荐结束时间",align:"center",sortable:""}}),r("el-table-column",{attrs:{label:"操作",width:"200",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{staticClass:"blue",attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(r){return e.handleEditRecommend(t.$index,t.row)}}},[e._v("修改时间")]),r("el-button",{staticClass:"red",attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(r){return e.handleCancelRecommend(t.$index,t.row)}}},[e._v("取消推荐")])]}}])})],1),r("div",{staticClass:"pagination"},[r("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","current-page":e.currentPage,"page-size":e.pageSize,total:e.total},on:{"current-change":e.handlePageChange,"prev-click":e.handlePagePrev,"next-click":e.handlePageNext}})],1)],1),r("el-dialog",{attrs:{title:"修改推荐",visible:e.recommendVisible,width:"30%","show-close":!1,"close-on-click-modal":!1},on:{"update:visible":function(t){e.recommendVisible=t}}},[r("el-form",{ref:"recommendForm",attrs:{model:e.recommendForm,rules:e.rules,"label-width":"120px"}},[r("el-form-item",{attrs:{label:"楹联家名字",prop:"masterName"}},[r("el-input",{attrs:{disabled:!0},model:{value:e.recommendForm.masterName,callback:function(t){e.$set(e.recommendForm,"masterName",t)},expression:"recommendForm.masterName"}})],1),r("el-form-item",{attrs:{label:"推荐开始时间",prop:"masterRecommendStartDate"}},[r("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择开始推荐时间"},model:{value:e.recommendForm.masterRecommendStartDate,callback:function(t){e.$set(e.recommendForm,"masterRecommendStartDate",t)},expression:"recommendForm.masterRecommendStartDate"}})],1),r("el-form-item",{attrs:{label:"推荐结束时间",prop:"masterRecommendEndDate"}},[r("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择结束推荐时间"},model:{value:e.recommendForm.masterRecommendEndDate,callback:function(t){e.$set(e.recommendForm,"masterRecommendEndDate",t)},expression:"recommendForm.masterRecommendEndDate"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.cancelEditRecommend}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.saveEditRecommend("recommendForm")}}},[e._v("确 定")])],1)],1)],1)},n=[],s=(r("96cf"),r("1da1")),c=r("fa7d"),o={name:"MasterRecommend",data:function(){return{inputKey:"",masterList:[],currentPage:1,pageSize:10,total:0,recommendIndex:-1,recommendVisible:!1,recommendForm:{},rules:{masterRecommendStartDate:[{required:!0,message:"请选择推荐开始时间",trigger:"blur"}],masterRecommendEndDate:[{required:!0,message:"请选择推荐结束时间",trigger:"blur"}]}}},activated:function(){this.inputKey="",this.currentPage=1,this.getMasterRecommendList()},methods:{getMasterRecommendList:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={inputKey:this.inputKey,pageSize:this.pageSize,currentPage:this.currentPage},e.prev=1,e.next=4,this.$api.recommend.getMasterRecommendList(t);case 4:r=e.sent,this.total=r.total,this.masterList=r.masterList,e.next=13;break;case 9:e.prev=9,e.t0=e["catch"](1),this.$message({message:"获取楹联家推荐列表失败",duration:2e3,type:"error"}),console.log(e.t0);case 13:case"end":return e.stop()}}),e,this,[[1,9]])})));function t(){return e.apply(this,arguments)}return t}(),handleRefresh:function(){var e=this.$message("刷新中");this.currentPage=1,this.inputKey="",this.getMasterRecommendList(),e.close()},handleSearch:function(){this.currentPage=1,this.getMasterRecommendList()},handlePageChange:function(e){this.currentPage=e,this.getMasterRecommendList()},handlePagePrev:function(){this.currentPage--},handlePageNext:function(){this.currentPage++},handleCancelRecommend:function(e,t){var r=this;this.$confirm("该楹联家将不在首页推荐展示，确定要继续吗？","提示",{type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then(Object(s["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={masterId:t.masterId},e.prev=1,e.next=4,r.$api.recommend.cancelRecommendMaster(a);case 4:r.$message({message:"取消推荐成功",duration:2e3,type:"success"}),r.getMasterRecommendList(),e.next=12;break;case 8:e.prev=8,e.t0=e["catch"](1),r.$message({message:"取消推荐失败",duration:2e3,type:"error"}),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})))).catch((function(){r.$message({message:"操作已取消",duration:1500,type:"info"})}))},cancelEditRecommend:function(){this.recommendVisible=!1,this.$message({message:"操作已取消",duration:1500,type:"info"}),this.recommendForm={},this.$refs["recommendForm"].clearValidate()},handleEditRecommend:function(e,t){this.recommendVisible=!0,this.recommendIndex=e,this.recommendForm=JSON.parse(JSON.stringify(t))},saveEditRecommend:function(e){var t=this;this.$refs[e].validate(function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(r){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!r){e.next=18;break}if(a={masterId:t.recommendForm.masterId,masterRecommendStartDate:t.recommendForm.masterRecommendStartDate,masterRecommendEndDate:t.recommendForm.masterRecommendEndDate},c["a"].compareRecommendDate(a.masterRecommendStartDate,a.masterRecommendEndDate)){e.next=4;break}return e.abrupt("return",!1);case 4:return t.recommendVisible=!1,e.prev=5,e.next=8,t.$api.couplet.recommendMaster(a);case 8:t.$message({message:"修改推荐成功",duration:2e3,type:"success"}),t.$set(t.masterList,t.recommendIndex,t.recommendForm),e.next=16;break;case 12:e.prev=12,e.t0=e["catch"](5),t.$message({message:"修改推荐失败",duration:2e3,type:"error"}),console.log(e.t0);case 16:e.next=20;break;case 18:return console.log("修改推荐楹联家表单验证失败"),e.abrupt("return",!1);case 20:case"end":return e.stop()}}),e,null,[[5,12]])})));return function(t){return e.apply(this,arguments)}}())}}},m=o,i=(r("58c3"),r("0c7c")),l=Object(i["a"])(m,a,n,!1,null,"69a2dcb4",null);t["default"]=l.exports}}]);
//# sourceMappingURL=MasterRecommend.f51585c6.js.map