(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["ReviewerManage"],{"4c01":function(e,t,i){},a535:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"crumbs"},[i("el-breadcrumb",{attrs:{separator:"/"}},[i("el-breadcrumb-item",[i("i",{staticClass:"el-icon-lx-cascades"}),e._v(" 评审人员管理\n            ")])],1)],1),i("div",{staticClass:"container"},[i("div",{staticClass:"handle-box"},[e._v("\n            请选择比赛场次: \n            "),i("el-select",{attrs:{placeholder:"请选择比赛"},on:{change:e.changeCompetitionOptions},model:{value:e.selectedCompetitionId,callback:function(t){e.selectedCompetitionId=t},expression:"selectedCompetitionId"}},e._l(e.competitionOptions,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),i("div",[i("el-tabs",{staticClass:"tabs_wrap",attrs:{type:"border-card",tabPosition:"left"}},[i("el-tab-pane",{attrs:{label:"一审人员"}},[e.isSet?i("div",[i("div",{staticClass:"right_title"},[e._v("一审人员信息")]),i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.selectedReviewer,height:"200px"}},[i("el-table-column",{attrs:{prop:"adminName",label:"账号"}}),i("el-table-column",{attrs:{prop:"manuNumber",label:"评审数量"}})],1)],1):i("div",[i("div",{staticClass:"tabs_content"},[i("div",{staticClass:"left"},[i("div",{staticClass:"left_title"},[e._v("添加一审人员")]),i("div",{staticClass:"common_style"},[e._v("\n                                    请选择评审账号: \n                                    "),i("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择账号"},model:{value:e.selectedAdminId,callback:function(t){e.selectedAdminId=t},expression:"selectedAdminId"}},e._l(e.adminOptions,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),i("div",{staticClass:"common_style"},[e._v("\n                                    请输入评审数量: \n                                    "),i("el-input-number",{staticStyle:{width:"200px"},attrs:{step:e.step},model:{value:e.manuNumber,callback:function(t){e.manuNumber=t},expression:"manuNumber"}})],1),i("div",{staticClass:"common_style"},[e._v("\n                                    剩余的投稿数量: \n                                    "),i("el-tag",{attrs:{size:"medium"}},[e._v(e._s(e.manuTotal))])],1),i("div",{staticStyle:{"text-align":"right","padding-top":"58px"}},[i("el-button",{attrs:{type:"primary"},on:{click:e.add}},[e._v("添 加")])],1)]),i("div",{staticClass:"right"},[i("div",{staticClass:"right_title"},[e._v("已选一审人员")]),i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.selectedReviewer,size:"mini",height:"200px"}},[i("el-table-column",{attrs:{prop:"adminName",label:"账号"}}),i("el-table-column",{attrs:{prop:"manuNumber",label:"评审数量"}}),i("el-table-column",{attrs:{prop:"manuNumber",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(i){return e.cancel(t.row,t.$index)}}},[e._v("撤 回")])]}}],null,!1,2195546385)})],1),i("div",{staticStyle:{"text-align":"right","padding-top":"10px"}},[i("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("提 交")])],1)],1)])])]),i("el-tab-pane",{attrs:{label:"二审人员"}},[e.isSet_1?i("div",[i("div",{staticClass:"right_title"},[e._v("二审人员信息")]),i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.selectedReviewer_1,height:"200px"}},[i("el-table-column",{attrs:{prop:"adminName",label:"账号"}}),i("el-table-column",{attrs:{prop:"manuNumber",label:"评审数量"}})],1)],1):i("div",[i("div",{staticClass:"tabs_content"},[i("div",{staticClass:"left"},[i("div",{staticClass:"left_title"},[e._v("添加二审人员")]),i("div",{staticClass:"common_style"},[e._v("\n                                    请选择评审账号: \n                                    "),i("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择账号"},model:{value:e.selectedAdminId_1,callback:function(t){e.selectedAdminId_1=t},expression:"selectedAdminId_1"}},e._l(e.adminOptions_1,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),i("div",{staticClass:"common_style"},[e._v("\n                                    请输入评审数量: \n                                    "),i("el-input-number",{staticStyle:{width:"200px"},attrs:{step:e.step},model:{value:e.manuNumber_1,callback:function(t){e.manuNumber_1=t},expression:"manuNumber_1"}})],1),i("div",{staticClass:"common_style"},[e._v("\n                                    剩余的投稿数量: \n                                    "),i("el-tag",{attrs:{size:"medium"}},[e._v(e._s(e.manuTotal_1))])],1),i("div",{staticStyle:{"text-align":"right","padding-top":"58px"}},[i("el-button",{attrs:{type:"primary"},on:{click:e.add_1}},[e._v("添 加")])],1)]),i("div",{staticClass:"right"},[i("div",{staticClass:"right_title"},[e._v("已选二审人员")]),i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.selectedReviewer_1,size:"mini",height:"200px"}},[i("el-table-column",{attrs:{prop:"adminName",label:"账号"}}),i("el-table-column",{attrs:{prop:"manuNumber",label:"评审数量"}}),i("el-table-column",{attrs:{prop:"manuNumber",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(i){return e.cancel_1(t.row,t.$index)}}},[e._v("撤 回")])]}}],null,!1,1830897375)})],1),i("div",{staticStyle:{"text-align":"right","padding-top":"10px"}},[i("el-button",{attrs:{type:"primary"},on:{click:e.submit_1}},[e._v("提 交")])],1)],1)])])])],1)],1)])])},n=[],s=(i("20d6"),i("ac6a"),i("96cf"),i("1da1")),r=(i("55dd"),{name:"ReviewerManage",data:function(){return{competitionList:[],adminList:[],selectedCompetitionId:"",step:20,isSet:!1,competitionOptions:[],adminOptions:[],selectedAdminId:"",manuNumber:100,manuTotal:0,selectedReviewer:[],isSet_1:!1,competitionOptions_1:[],adminOptions_1:[],selectedAdminId_1:"",manuNumber_1:100,manuTotal_1:0,selectedReviewer_1:[]}},activated:function(){this.getCompetitionList(),this.getAllAdmin()},methods:{sortByTime:function(e){return e.sort((function(e,t){var i=new Date(e.createTime).getTime(),a=new Date(t.createtime).getTime();return i>a?-1:i<a?1:0}))},getCompetitionList:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$api.competition.getAllCompetition();case 3:t=e.sent,this.competitionList=this.sortByTime(t.competitionList),i=[],this.competitionList.forEach((function(e,t){i.push({value:e.competitionId,label:e.competitionName})})),this.competitionOptions=i,e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](0),this.$message({message:"获取比赛列表失败",duration:2e3,type:"error"}),console.log(e.t0);case 14:case"end":return e.stop()}}),e,this,[[0,10]])})));function t(){return e.apply(this,arguments)}return t}(),getAllAdmin:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$api.admin.getAdminList();case 3:t=e.sent,this.adminList=t.adminList,i=[],this.adminList.forEach((function(e,t){i.push({value:e.adminId,label:e.adminName})})),this.adminOptions=i,this.adminOptions_1=i,e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](0),this.$message({message:"获取管理员列表失败",duration:2e3,type:"error"}),console.log(e.t0);case 15:case"end":return e.stop()}}),e,this,[[0,11]])})));function t(){return e.apply(this,arguments)}return t}(),changeCompetitionOptions:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var i,a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t){e.next=11;break}return this.reset(),i={competitionId:t},e.prev=3,e.delegateYield(regeneratorRuntime.mark((function e(){var t,n,s,r,l,m,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a.$api.admin.getReviewerList(i);case 2:if(t=e.sent,a.manuTotal=t.manuTotal,a.manuTotal_1=t.manuTotal,t.data.reviewerList1&&0!=t.data.reviewerList1.length){for(a.isSet=!0,n=[],s=function(e){var i=a.adminList.findIndex((function(i,a){return i.adminId==t.data.reviewerList1[e].manuscriptReviewerId})),s={};s.adminId=a.adminList[i].adminId,s.adminName=a.adminList[i].adminName,s.manuNumber=t.data.reviewerList1[e].manuNumber,n.push(s)},r=0;r<t.data.reviewerList1.length;r++)s(r);a.selectedReviewer=n}else a.isSet=!1;if(t.data.reviewerList2&&0!=t.data.reviewerList2.length){for(a.isSet_1=!0,l=[],m=function(e){var i=a.adminList.findIndex((function(i,a){return i.adminId==t.data.reviewerList2[e].manuscriptRecheckerId})),n={};n.adminId=a.adminList[i].adminId,n.adminName=a.adminList[i].adminName,n.manuNumber=t.data.reviewerList2[e].manuNumber,l.push(n)},c=0;c<t.data.reviewerList2.length;c++)m(c);a.selectedReviewer_1=l}else a.isSet_1=!1;case 7:case"end":return e.stop()}}),e)}))(),"t0",5);case 5:e.next=11;break;case 7:e.prev=7,e.t1=e["catch"](3),this.$message({message:"获取该比赛评审人员信息失败",duration:2e3,type:"error"}),console.log(e.t1);case 11:case"end":return e.stop()}}),e,this,[[3,7]])})));function t(t){return e.apply(this,arguments)}return t}(),add:function(){var e=this;if(this.selectedAdminId&&this.manuNumber>0&&this.manuNumber<=this.manuTotal){var t=this.adminList.findIndex((function(t,i){return t.adminId===e.selectedAdminId}));this.selectedReviewer.push({adminId:this.selectedAdminId,manuNumber:this.manuNumber,adminName:this.adminList[t].adminName}),this.adminOptions=this.adminOptions.filter((function(t,i){return t.value!==e.selectedAdminId})),this.manuTotal-=this.manuNumber,this.selectedAdminId="",this.manuNumber=100}else this.$message({message:"未选择账号或数量不规范",duration:2e3,type:"warning"})},cancel:function(e,t){this.adminOptions.push({value:e.adminId,label:e.adminName}),this.manuTotal+=e.manuNumber,this.selectedReviewer.splice(t,1)},submit:function(){var e=this;this.selectedCompetitionId?this.manuTotal>0?this.$message({message:"还有投稿剩余，请分配后再进行提交",type:"warning"}):this.$confirm("提交之后将无法修改，确定要提交吗？","提示",{type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function t(){var i,a,n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(i=[],a=0;a<e.selectedReviewer.length;a++)n={},n.adminId=e.selectedReviewer[a].adminId,n.manuNumber=e.selectedReviewer[a].manuNumber,i.push(n);return s={competitionId:e.selectedCompetitionId,reviewers:JSON.stringify(i)},t.prev=3,t.next=6,e.$api.admin.setReviewer(s);case 6:e.$message({message:"设置一审人员成功",duration:2e3,type:"success"}),e.isSet=!0,t.next=14;break;case 10:t.prev=10,t.t0=t["catch"](3),e.$message({message:"设置一审人员失败",duration:2e3,type:"error"}),console.log(t.t0);case 14:case"end":return t.stop()}}),t,null,[[3,10]])})))).catch((function(){e.$message({message:"操作已取消",duration:1500,type:"info"})})):this.$message({message:"请先选择比赛进行分配",type:"warning"})},add_1:function(){var e=this;if(this.selectedAdminId_1&&this.manuNumber_1>0&&this.manuNumber_1<=this.manuTotal_1){var t=this.adminList.findIndex((function(t,i){return t.adminId===e.selectedAdminId_1}));this.selectedReviewer_1.push({adminId:this.selectedAdminId_1,manuNumber:this.manuNumber_1,adminName:this.adminList[t].adminName}),this.adminOptions_1=this.adminOptions_1.filter((function(t,i){return t.value!==e.selectedAdminId_1})),this.manuTotal_1-=this.manuNumber_1,this.selectedAdminId_1="",this.manuNumber_1=100}else this.$message({message:"未选择账号或数量不规范",duration:2e3,type:"warning"})},cancel_1:function(e,t){this.adminOptions_1.push({value:e.adminId,label:e.adminName}),this.manuTotal_1+=e.manuNumber,this.selectedReviewer_1.splice(t,1)},submit_1:function(){var e=this;this.manuTotal_1>0?this.$message({message:"还有投稿剩余，请分配后再进行提交",type:"warning"}):this.$confirm("提交之后将无法修改，确定要提交吗？","提示",{type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function t(){var i,a,n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(i=[],a=0;a<e.selectedReviewer_1.length;a++)n={},n.adminId=e.selectedReviewer_1[a].adminId,n.manuNumber=e.selectedReviewer_1[a].manuNumber,i.push(n);return s={competitionId:e.selectedCompetitionId,reviewers:JSON.stringify(i)},t.prev=3,t.next=6,e.$api.admin.setRechecker(s);case 6:e.$message({message:"设置二审人员成功",duration:2e3,type:"success"}),e.isSet_1=!0,t.next=14;break;case 10:t.prev=10,t.t0=t["catch"](3),e.$message({message:"设置二审人员失败",duration:2e3,type:"error"}),console.log(t.t0);case 14:case"end":return t.stop()}}),t,null,[[3,10]])})))).catch((function(){e.$message({message:"操作已取消",duration:1500,type:"info"})}))},reset:function(){this.isSet=!1,this.adminOptions=[],this.selectedAdminId="",this.manuNumber=100,this.manuTotal=0,this.selectedReviewer=[],this.isSet_1=!1,this.adminOptions_1=[],this.selectedAdminId_1="",this.manuNumber_1=100,this.manuTotal_1=0,this.selectedReviewer_1=[]}}}),l=r,m=(i("dfab"),i("0c7c")),c=Object(m["a"])(l,a,n,!1,null,"292c44b1",null);t["default"]=c.exports},dfab:function(e,t,i){"use strict";i("4c01")}}]);
//# sourceMappingURL=ReviewerManage.ddd48ecd.js.map