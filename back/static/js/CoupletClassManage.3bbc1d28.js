(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["CoupletClassManage"],{"1a1c":function(e,t,a){"use strict";a("8501")},"554d":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-lx-cascades"}),e._v(" 对联课堂管理\n            ")])],1)],1),a("div",{staticClass:"container"},[a("div",{staticClass:"handle-box"},[a("el-input",{staticClass:"handle-input mr10",attrs:{placeholder:"标题/简介关键字"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch(t)}},model:{value:e.inputKey,callback:function(t){e.inputKey=t},expression:"inputKey"}}),a("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:e.handleRefresh}},[e._v("刷新")]),a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleSearch}},[e._v("搜索")]),a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.handleAdd}},[e._v("新建")])],1),a("el-table",{ref:"multipleTable",staticClass:"table",attrs:{data:e.coupletClassList,border:"","header-cell-class-name":"table-header"}},[a("el-table-column",{attrs:{prop:"coupletClassTitle","min-width":"200",label:"课堂资料标题",align:"center"}}),a("el-table-column",{attrs:{label:"封面图(查看大图)","min-width":"130",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("el-image",{staticClass:"table-td-thumb",attrs:{src:e.row.coupletClassImage,"preview-src-list":[e.row.coupletClassImage]}})]}}])}),a("el-table-column",{attrs:{"min-width":"200",label:"课堂资料内容",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-link",{attrs:{href:t.row.coupletClassSrc,type:"primary",target:"_blank"}},[a("i",{staticClass:"el-icon-view"}),e._v("课堂公众号链接")])]}}])}),a("el-table-column",{attrs:{label:"操作",width:"200",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"blue",attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}},[e._v("修改")]),a("el-button",{staticClass:"red",attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")]),e.whetherShow(t.$index,t.row)?a("el-button",{staticClass:"orange",attrs:{type:"text",icon:"el-icon-s-promotion"},on:{click:function(a){return e.handleRecommend(t.$index,t.row)}}},[e._v("推荐")]):e._e()]}}])})],1),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","current-page":e.currentPage,"page-size":e.pageSize,total:e.total},on:{"current-change":e.handlePageChange,"prev-click":e.handlePagePrev,"next-click":e.handlePageNext}})],1)],1),a("el-dialog",{attrs:{title:"编辑",visible:e.editVisible,width:"50%","show-close":!1,"close-on-click-modal":!1},on:{"update:visible":function(t){e.editVisible=t}}},[a("el-form",{ref:"editForm",attrs:{model:e.editForm,rules:e.rules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"课堂资料标题",prop:"coupletClassTitle"}},[a("el-input",{model:{value:e.editForm.coupletClassTitle,callback:function(t){e.$set(e.editForm,"coupletClassTitle",t)},expression:"editForm.coupletClassTitle"}})],1),a("el-form-item",{attrs:{label:"课堂资料链接",prop:"coupletClassSrc"}},[a("el-input",{attrs:{type:"textarea",autosize:""},model:{value:e.editForm.coupletClassSrc,callback:function(t){e.$set(e.editForm,"coupletClassSrc",t)},expression:"editForm.coupletClassSrc"}})],1),a("el-form-item",{attrs:{label:"课堂资料封面图最优宽高2:1",prop:"coupletClassImage"}},[a("el-upload",{ref:"upload",staticClass:"cc-avatar-uploader",attrs:{action:"uploadUrl","show-file-list":!1,limit:1,"http-request":e.uploadPicture,"before-upload":e.beforeAvatarUpload}},[e.editForm.coupletClassImage?a("el-image",{staticClass:"cc-avatar",attrs:{src:e.editForm.coupletClassImage,fit:"contain"}}):a("i",{staticClass:"el-icon-plus cc-avatar-uploader-icon"})],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelEdit}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.saveEdit("editForm")}}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"新增",visible:e.addVisible,width:"50%","show-close":!1,"close-on-click-modal":!1},on:{"update:visible":function(t){e.addVisible=t}}},[a("el-form",{ref:"addForm",attrs:{model:e.addForm,rules:e.rules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"课堂资料标题",prop:"coupletClassTitle"}},[a("el-input",{model:{value:e.addForm.coupletClassTitle,callback:function(t){e.$set(e.addForm,"coupletClassTitle",t)},expression:"addForm.coupletClassTitle"}})],1),a("el-form-item",{attrs:{label:"课堂资料公众号文章链接",prop:"coupletClassSrc"}},[a("el-input",{attrs:{type:"textarea",autosize:""},model:{value:e.addForm.coupletClassSrc,callback:function(t){e.$set(e.addForm,"coupletClassSrc",t)},expression:"addForm.coupletClassSrc"}})],1),a("el-form-item",{attrs:{label:"课堂资料封面图最优宽高2:1",prop:"coupletClassImage"}},[a("el-upload",{ref:"upload",staticClass:"cc-avatar-uploader",attrs:{action:"uploadUrl","show-file-list":!1,limit:1,"http-request":e.uploadPicture_add,"before-upload":e.beforeAvatarUpload}},[e.addForm.coupletClassImage?a("el-image",{staticClass:"cc-avatar",attrs:{src:e.addForm.coupletClassImage,fit:"contain"}}):a("i",{staticClass:"el-icon-plus cc-avatar-uploader-icon"})],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelAdd}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.saveAdd("addForm")}}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"推荐",visible:e.recommendVisible,width:"30%","show-close":!1,"close-on-click-modal":!1},on:{"update:visible":function(t){e.recommendVisible=t}}},[a("el-form",{ref:"recommendForm",attrs:{model:e.recommendForm,rules:e.rules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"课堂资料标题",prop:"coupletClassTitle"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.recommendForm.coupletClassTitle,callback:function(t){e.$set(e.recommendForm,"coupletClassTitle",t)},expression:"recommendForm.coupletClassTitle"}})],1),a("el-form-item",{attrs:{label:"推荐开始时间",prop:"coupletRecommendStartDate"}},[a("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择开始推荐时间"},model:{value:e.recommendForm.coupletRecommendStartDate,callback:function(t){e.$set(e.recommendForm,"coupletRecommendStartDate",t)},expression:"recommendForm.coupletRecommendStartDate"}})],1),a("el-form-item",{attrs:{label:"推荐结束时间",prop:"coupletRecommendEndDate"}},[a("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择结束推荐时间"},model:{value:e.recommendForm.coupletRecommendEndDate,callback:function(t){e.$set(e.recommendForm,"coupletRecommendEndDate",t)},expression:"recommendForm.coupletRecommendEndDate"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelRecommend}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.saveRecommend("recommendForm")}}},[e._v("确 定")])],1)],1)],1)},r=[],l=(a("96cf"),a("1da1")),o=a("fa7d"),n={name:"CoupletClassManage",data:function(){return{inputKey:"",coupletClassList:[],pageSize:10,currentPage:1,total:0,editForm:{},editIndex:-1,editVisible:!1,addForm:{coupletClassTitle:"",coupletClassDescription:"暂无",coupletClassSrc:"",coupletClassImage:""},addVisible:!1,recommendVisible:!1,recommendIndex:-1,recommendForm:{},whetherChange:!1,rules:{coupletClassTitle:[{required:!0,message:"请输入资料标题",trigger:"blur"}],coupletClassSrc:[{required:!0,message:"请输入公众号文章链接",trigger:"blur"}],coupletClassImage:[{required:!0,message:"请选择图片",trigger:"blur"}]}}},activated:function(){this.inputKey="",this.currentPage=1,this.getCoupletClassList()},methods:{getCoupletClassList:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={currentPage:this.currentPage,pageSize:this.pageSize,inputKey:this.inputKey},e.prev=1,e.next=4,this.$api.document.getCoupletClassList(t);case 4:a=e.sent,this.coupletClassList=a.coupletClassList,this.total=a.total,e.next=13;break;case 9:e.prev=9,e.t0=e["catch"](1),this.$message({message:"获取课堂资料列表失败",duration:2e3,type:"error"}),console.log(e.t0);case 13:case"end":return e.stop()}}),e,this,[[1,9]])})));function t(){return e.apply(this,arguments)}return t}(),handleRefresh:function(){var e=this.$message("刷新中");this.currentPage=1,this.inputKey="",this.getCoupletClassList(),e.close()},handleSearch:function(){this.currentPage=1,this.getCoupletClassList()},handlePageChange:function(e){this.currentPage=e,this.getCoupletClassList()},handlePagePrev:function(){this.currentPage--},handlePageNext:function(){this.currentPage++},deletePhoto:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={url:t},e.prev=1,e.next=4,this.$api.document.deletePicture(a);case 4:console.log("课堂资料原有图片删除成功"),e.next=11;break;case 7:e.prev=7,e.t0=e["catch"](1),console.log("课堂资料原有图片删除失败"),console.log(e.t0);case 11:case"end":return e.stop()}}),e,this,[[1,7]])})));function t(t){return e.apply(this,arguments)}return t}(),beforeAvatarUpload:function(e){var t="image/jpeg"===e.type||"image/png"===e.type;return t?this.$message({message:"上传中"}):this.$message.error("上传封面图片只能是 JPG或者PNG 格式!"),t},uploadPicture:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o["a"].uploadFile("/file-server/document/back/uploadPicture",t.file);case 3:a=e.sent,this.$set(this.editForm,"coupletClassImage",a.url),this.$message({message:"图片上传成功",duration:2e3,type:"success"}),this.whetherChange=!0,this.$refs.upload.clearFiles(),e.next=15;break;case 10:e.prev=10,e.t0=e["catch"](0),this.$refs.upload.clearFiles(),console.log(e.t0),this.$message({message:"图片上传失败",duration:2e3,type:"error"});case 15:case"end":return e.stop()}}),e,this,[[0,10]])})));function t(t){return e.apply(this,arguments)}return t}(),uploadPicture_add:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o["a"].uploadFile("/file-server/document/back/uploadPicture",t.file);case 3:a=e.sent,this.$set(this.addForm,"coupletClassImage",a.url),this.$message({message:"图片上传成功",duration:2e3,type:"success"}),this.$refs.upload.clearFiles(),e.next=14;break;case 9:e.prev=9,e.t0=e["catch"](0),this.$refs.upload.clearFiles(),console.log(e.t0),this.$message({message:"图片上传失败",duration:2e3,type:"error"});case 14:case"end":return e.stop()}}),e,this,[[0,9]])})));function t(t){return e.apply(this,arguments)}return t}(),handleDelete:function(e,t){var a=this;this.$confirm("该资料将永久删除，确定要继续吗","提示",{type:"warning"}).then(Object(l["a"])(regeneratorRuntime.mark((function e(){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s={coupletClassId:t.coupletClassId},e.prev=1,e.next=4,a.$api.document.deleteCoupletClass(s);case 4:return a.$message({message:"删除资料成功",duration:2e3,type:"success"}),s={url:t.coupletClassImage},e.prev=6,e.next=9,a.$api.document.deletePicture(s);case 9:console.log("资料图片删除成功"),e.next=16;break;case 12:e.prev=12,e.t0=e["catch"](6),console.log("资料图片删除失败"),console.log(e.t0);case 16:a.getCoupletClassList(),e.next=23;break;case 19:e.prev=19,e.t1=e["catch"](1),a.$message({message:"删除资料失败",duration:2e3,type:"error"}),console.log(e.t1);case 23:a.getCoupletClassList();case 24:case"end":return e.stop()}}),e,null,[[1,19],[6,12]])})))).catch((function(){a.$message({message:"操作已取消",duration:1500,type:"info"})}))},cancelEdit:function(){this.editVisible=!1,this.$message({message:"操作已取消",duration:1500,type:"info"}),this.$refs["editForm"].clearValidate()},cancelAdd:function(){this.addVisible=!1,this.$message({message:"操作已取消",duration:1500,type:"info"}),this.$refs["addForm"].clearValidate()},handleAdd:function(e,t){this.addVisible=!0},handleEdit:function(e,t){this.editIndex=e,this.editForm=JSON.parse(JSON.stringify(t)),this.editForm.coupletClassDescription="暂无",this.editVisible=!0},saveEdit:function(e){var t=this;this.$refs[e].validate(function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(a){var s,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!a){e.next=18;break}return s=t.coupletClassList[t.editIndex].coupletClassImage,t.editVisible=!1,r={coupletClassId:t.editForm.coupletClassId,coupletClassTitle:t.editForm.coupletClassTitle,coupletClassSrc:t.editForm.coupletClassSrc,coupletClassImage:t.editForm.coupletClassImage,coupletClassDescription:t.editForm.coupletClassDescription},e.prev=4,e.next=7,t.$api.document.modifyCoupletClass(r);case 7:t.$message({message:"修改课堂资料成功",duration:2e3,type:"success"}),t.$set(t.coupletClassList,t.editIndex,t.editForm),t.whetherChange&&t.deletePhoto(s),e.next=16;break;case 12:e.prev=12,e.t0=e["catch"](4),t.$message({message:"修改课堂资料失败",duration:2e3,type:"error"}),console.log(e.t0);case 16:e.next=20;break;case 18:return console.log("修改课堂资料表单验证失败"),e.abrupt("return",!1);case 20:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(t){return e.apply(this,arguments)}}())},saveAdd:function(e){var t=this;this.$refs[e].validate(function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(a){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!a){e.next=17;break}return t.addVisible=!1,e.prev=2,e.next=5,t.$api.document.addCoupletClass(t.addForm);case 5:t.$message({message:"增加课堂资料成功",duration:2e3,type:"success"}),t.reset(),t.currentPage=1,t.getCoupletClassList(),e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](2),t.$message({message:"增加课堂资料失败",duration:2e3,type:"error"}),console.log(e.t0);case 15:e.next=19;break;case 17:return console.log("增加课堂资料表单验证失败"),e.abrupt("return",!1);case 19:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t){return e.apply(this,arguments)}}())},reset:function(){this.addForm={coupletClassImage:"",coupletClassSrc:"",coupletClassDescription:"",coupletClassTitle:""},this.$refs["addForm"].clearValidate()},handleRecommend:function(e,t){this.recommendVisible=!0,this.recommendIndex=e,this.recommendForm=JSON.parse(JSON.stringify(t))},whetherShow:function(e,t){if(t.coupletRecommendStartDate){var a=new Date(t.coupletRecommendStartDate).getTime(),s=new Date(t.coupletRecommendEndDate).getTime(),r=(new Date).getTime();return!(r>a&&r<s)}return!0},cancelRecommend:function(){this.recommendVisible=!1,this.$message({message:"操作已取消",duration:1500,type:"info"}),this.recommendForm={},this.$refs["recommendForm"].clearValidate()},saveRecommend:function(e){var t=this;this.$refs[e].validate(function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(a){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!a){e.next=18;break}if(s={coupletClassId:t.recommendForm.coupletClassId,coupletRecommendStartDate:t.recommendForm.coupletRecommendStartDate,coupletRecommendEndDate:t.recommendForm.coupletRecommendEndDate},o["a"].compareRecommendDate(s.coupletRecommendStartDate,s.coupletRecommendEndDate)){e.next=4;break}return e.abrupt("return",!1);case 4:return t.recommendVisible=!1,e.prev=5,e.next=8,t.$api.document.recommendCoupletClass(s);case 8:t.$message({message:"推荐成功",duration:2e3,type:"success"}),t.$set(t.coupletClassList,t.recommendIndex,t.recommendForm),e.next=16;break;case 12:e.prev=12,e.t0=e["catch"](5),t.$message({message:"推荐失败",duration:2e3,type:"error"}),console.log(e.t0);case 16:e.next=20;break;case 18:return console.log("推荐对联课堂表单验证失败"),e.abrupt("return",!1);case 20:case"end":return e.stop()}}),e,null,[[5,12]])})));return function(t){return e.apply(this,arguments)}}())}}},i=n,c=(a("1a1c"),a("0c7c")),u=Object(c["a"])(i,s,r,!1,null,null,null);t["default"]=u.exports},8501:function(e,t,a){}}]);
//# sourceMappingURL=CoupletClassManage.3bbc1d28.js.map