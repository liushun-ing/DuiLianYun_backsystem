(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["DocumentUpload"],{"09cb":function(e,t,r){"use strict";r("bfa4")},"2f7c":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"crumbs"},[r("el-breadcrumb",{attrs:{separator:"/"}},[r("el-breadcrumb-item",[r("i",{staticClass:"el-icon-lx-cascades"}),e._v(" 资料上传\n            ")])],1)],1),r("div",{staticClass:"container"},[r("div",{staticClass:"d-form-box"},[r("el-form",{ref:"documentForm",attrs:{rules:e.rules,model:e.documentForm,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"资料名称",prop:"documentName"}},[r("el-input",{staticStyle:{width:"500px"},model:{value:e.documentForm.documentName,callback:function(t){e.$set(e.documentForm,"documentName",t)},expression:"documentForm.documentName"}})],1),r("div",{staticStyle:{display:"flex"}},[r("el-form-item",{attrs:{label:"资料封面最优宽高3:4",prop:"documentPicture"}},[r("el-upload",{ref:"upload",staticClass:"d-avatar-uploader",attrs:{action:"uploadPictureURL","show-file-list":!1,limit:1,"http-request":e.uploadPicture,"before-upload":e.beforeAvatarUpload}},[e.documentForm.documentPicture?r("el-image",{staticClass:"d-avatar",attrs:{src:e.documentForm.documentPicture,fit:"contain"}}):r("i",{staticClass:"el-icon-plus d-avatar-uploader-icon"})],1)],1),r("el-form-item",{staticStyle:{"padding-left":"10px"},attrs:{label:"资料简介",prop:"documentIntroduction"}},[r("el-input",{staticClass:"introduction",attrs:{type:"textarea",autosize:{minRows:9,maxRows:9}},model:{value:e.documentForm.documentIntroduction,callback:function(t){e.$set(e.documentForm,"documentIntroduction",t)},expression:"documentForm.documentIntroduction"}})],1)],1),r("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[r("el-form-item",{attrs:{label:"资料文件小于10M",prop:"documentFileId"}},[r("el-upload",{ref:"uploadFile",staticClass:"file_wrap",attrs:{action:"uploadFileURL","http-request":e.uploadFile,"before-upload":e.beforeFileUpload,limit:1}},[r("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击选择文件")])],1)],1),r("el-form-item",[r("el-button",{attrs:{type:"success"},on:{click:function(t){return e.onSubmit("documentForm")}}},[e._v("确 认 上 传")])],1)],1)],1)],1)])])},n=[],o=(r("7f7f"),r("96cf"),r("1da1")),s=r("fa7d"),c={name:"DocumentUpload",data:function(){return{documentForm:{documentName:"",documentIntroduction:"",documentFileId:"",documentPicture:"",documentUploaderId:s["a"].getSessionInfo("adminId")},messageObject:"",rules:{documentName:[{required:!0,message:"请输入资料名称",trigger:"blur"}],documentIntroduction:[{required:!0,message:"请输入资料简介",trigger:"blur"}],documentFileId:[{required:!0,message:"请上传资料文件",trigger:"blur"}],documentPicture:[{required:!0,message:"请上传资料封面",trigger:"blur"}]}}},methods:{onSubmit:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$refs[t].validate(function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t){e.next=15;break}return e.prev=1,e.next=4,r.$api.document.addDocument(r.documentForm);case 4:r.$message({message:"资料上传成功",duration:2e3,type:"success"}),r.documentForm={documentName:"",documentIntroduction:"",documentFileId:"",documentPicture:"",documentUploaderId:s["a"].getSessionInfo("adminId")},r.$refs.uploadFile.clearFiles(),e.next=13;break;case 9:e.prev=9,e.t0=e["catch"](1),r.$message({message:"资料上传失败",duration:2e3,type:"error"}),console.log(e.t0);case 13:e.next=17;break;case 15:return console.log("上传资料表单验证失败"),e.abrupt("return",!1);case 17:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),uploadPicture:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s["a"].uploadFile("/file-server/document/back/uploadPicture",t.file);case 3:r=e.sent,this.$set(this.documentForm,"documentPicture",r.url),this.$message({message:"图片上传成功",duration:2e3,type:"success"}),this.$refs.upload.clearFiles(),e.next=13;break;case 9:e.prev=9,e.t0=e["catch"](0),console.log(e.t0),this.$message({message:"图片上传失败",duration:2e3,type:"error"});case 13:case"end":return e.stop()}}),e,this,[[0,9]])})));function t(t){return e.apply(this,arguments)}return t}(),uploadFile:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s["a"].uploadFile("/file-server/document/back/uploadFile",t.file);case 3:r=e.sent,this.messageObject.close(),this.$set(this.documentForm,"documentFileId",r.fileId),this.$message({message:"文件上传成功",duration:2e3,type:"success"}),e.next=14;break;case 9:e.prev=9,e.t0=e["catch"](0),this.messageObject.close(),console.log(e.t0),this.$message({message:"文件上传失败",duration:2e3,type:"error"});case 14:case"end":return e.stop()}}),e,this,[[0,9]])})));function t(t){return e.apply(this,arguments)}return t}(),beforeAvatarUpload:function(e){var t="image/jpeg"===e.type||"image/png"===e.type;return t?(this.$message({message:"上传中"}),t):(this.$message.error("上传封面图片只能是 JPG或者PNG 格式!"),!1)},beforeFileUpload:function(e){var t=e.name.lastIndexOf("."),r=e.name.slice(t),a=".doc"===r||".pdf"===r||".xls"===r||".xlsx"===r||".docx"===r;if(!a)return this.$message.error("上传文件只能是 doc/docx/pdf/xls/xlsx 格式!"),!1;var n=e.size/1024/1024<10;return n?(this.messageObject=this.$message({message:"上传中",duration:-1}),!0):(this.$message.error("文件大小不能超过10M!"),!1)}}},i=c,u=(r("09cb"),r("0c7c")),l=Object(u["a"])(i,a,n,!1,null,null,null);t["default"]=l.exports},bfa4:function(e,t,r){}}]);
//# sourceMappingURL=DocumentUpload.bc2a8ca8.js.map