(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["MemberApplication"],{"61f7":function(e,t,i){},"78b7":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"crumbs"},[i("el-breadcrumb",{attrs:{separator:"/"}},[i("el-breadcrumb-item",[i("i",{staticClass:"el-icon-lx-cascades"}),e._v(" 会员申请审核\n            ")])],1)],1),i("div",{staticClass:"container"},[i("div",{staticClass:"handle-box"},[i("el-input",{staticClass:"handle-input mr10",attrs:{placeholder:"申请人姓名"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch(t)}},model:{value:e.inputKey,callback:function(t){e.inputKey=t},expression:"inputKey"}}),i("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:e.handleRefresh}},[e._v("刷新")]),i("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleSearch}},[e._v("搜索")])],1),i("el-table",{ref:"multipleTable",staticClass:"table",attrs:{data:e.memberApplicationList,border:"","header-cell-class-name":"table-header"}},[i("el-table-column",{attrs:{prop:"memberName",label:"申请人姓名","min-width":"100",align:"center"}}),i("el-table-column",{attrs:{label:"头像(查看大图)",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[i("el-image",{staticClass:"table-td-thumb",attrs:{src:e.row.memberPhoto,"preview-src-list":[e.row.memberPhoto]}})]}}])}),i("el-table-column",{attrs:{prop:"memberGender",label:"性别","min-width":"50",align:"center"}}),i("el-table-column",{attrs:{prop:"memberIdcard",label:"身份证号","min-width":"200",align:"center"}}),i("el-table-column",{attrs:{prop:"memberPhone",label:"电话号码","min-width":"120",align:"center"}}),i("el-table-column",{attrs:{prop:"memberWechat",label:"微信号",width:"100",align:"center"}}),i("el-table-column",{attrs:{prop:"memberPseudonym",label:"笔名",width:"100",align:"center"}}),i("el-table-column",{attrs:{prop:"memberBirthday",label:"生日",width:"100",align:"center"}}),i("el-table-column",{attrs:{prop:"memberNation",label:"民族",width:"100",align:"center"}}),i("el-table-column",{attrs:{prop:"memberParties",label:"党派",width:"100",align:"center"}}),i("el-table-column",{attrs:{prop:"memberEducation",label:"学历",width:"100",align:"center"}}),i("el-table-column",{attrs:{prop:"memberNativePlace",label:"籍贯",width:"150",align:"center"}}),i("el-table-column",{attrs:{prop:"memberWorkUnit",label:"工作单位",width:"150",align:"center"}}),i("el-table-column",{attrs:{prop:"memberAddress",label:"通联地址",width:"150",align:"center"}}),i("el-table-column",{attrs:{prop:"memberPostalCode",label:"邮政编码",width:"150",align:"center"}}),i("el-table-column",{attrs:{prop:"memberAbility",label:"专长",width:"150",align:"center"}}),i("el-table-column",{attrs:{prop:"memberIntroduction",label:"会员自我介绍",width:"250",align:"center"}}),i("el-table-column",{attrs:{prop:"memberCreateTime",label:"申请时间",width:"160",align:"center",sortable:""}}),i("el-table-column",{attrs:{label:"操作",width:"150",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[0===t.row.memberType?i("div",[i("el-button",{attrs:{type:"text",icon:"el-icon-success"},on:{click:function(i){return e.handlePass(t.$index,t.row)}}},[e._v("通过")]),i("el-button",{staticClass:"red",attrs:{type:"text",icon:"el-icon-error"},on:{click:function(i){return e.handleDeny(t.$index,t.row)}}},[e._v("不通过")])],1):2===t.row.memberType?i("div",[i("el-tag",[e._v("已通过")])],1):i("div",[i("el-tag",{attrs:{type:"info"}},[e._v("已拒绝")])],1)]}}])})],1),i("div",{staticClass:"pagination"},[i("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","current-page":e.currentPage,"page-size":e.pageSize,total:e.total},on:{"current-change":e.handlePageChange,"prev-click":e.handlePagePrev,"next-click":e.handlePageNext}})],1)],1),i("el-dialog",{attrs:{title:"申请审核",visible:e.passVisible,width:"40%","show-close":!1,"close-on-click-modal":!1},on:{"update:visible":function(t){e.passVisible=t}}},[i("el-form",{ref:"passForm",attrs:{model:e.passForm,rules:e.rules,"label-width":"150px"}},[i("el-form-item",{attrs:{label:"会员名字",prop:"memberName"}},[i("el-input",{attrs:{disabled:!0},model:{value:e.passForm.memberName,callback:function(t){e.$set(e.passForm,"memberName",t)},expression:"passForm.memberName"}})],1),i("el-form-item",{attrs:{label:"请分配会员证编号",prop:"memberUid"}},[i("el-input",{model:{value:e.passForm.memberUid,callback:function(t){e.$set(e.passForm,"memberUid",t)},expression:"passForm.memberUid"}})],1)],1),i("el-checkbox",{model:{value:e.isSendNotice,callback:function(t){e.isSendNotice=t},expression:"isSendNotice"}},[e._v("是否自动发送如下通知")]),i("el-descriptions",{staticStyle:{"padding-top":"10px"},attrs:{column:1,border:""}},[i("el-descriptions-item",{attrs:{label:"通知标题"}},[e._v(e._s(e.noticeForm.noticeTitle))]),i("el-descriptions-item",{attrs:{label:"通知内容"}},[e._v(e._s(e.noticeForm.noticeContent))])],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:e.cancelPass}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.savePass("passForm")}}},[e._v("确 定")])],1)],1),i("el-dialog",{attrs:{title:"提示",visible:e.denyVisible,width:"40%","show-close":!1,"close-on-click-modal":!1},on:{"update:visible":function(t){e.denyVisible=t}}},[i("div",{staticStyle:{"font-size":"18px","font-weight":"600","padding-bottom":"30px"}},[e._v("将拒绝该用户的会员申请，确定要继续吗？")]),i("el-checkbox",{model:{value:e.isSendNotice,callback:function(t){e.isSendNotice=t},expression:"isSendNotice"}},[e._v("是否自动发送如下通知")]),i("el-descriptions",{staticStyle:{"padding-top":"10px"},attrs:{column:1,border:""}},[i("el-descriptions-item",{attrs:{label:"通知标题"}},[e._v(e._s(e.noticeForm.noticeTitle))]),i("el-descriptions-item",{attrs:{label:"通知内容"}},[e._v(e._s(e.noticeForm.noticeContent))])],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:e.cancelDeny}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.saveDeny}},[e._v("确 定")])],1)],1)],1)},n=[],r=(i("96cf"),i("1da1")),s=i("fa7d"),l={name:"MemberApplication",data:function(){return{inputKey:"",memberApplicationList:[],currentPage:1,total:0,pageSize:10,passVisible:!1,passForm:{},passIndex:-1,denyVisible:!1,denyForm:{},denyIndex:-1,noticeForm:{},isSendNotice:!0,rules:{memberUid:[{required:!0,message:"请输入会员证编号",trigger:"blur"}]}}},activated:function(){this.currentPage=1,this.inputKey="",this.getMemberApplicationList()},methods:{getMemberApplicationList:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={pageSize:this.pageSize,currentPage:this.currentPage,inputKey:this.inputKey},e.prev=1,e.next=4,this.$api.user.getMemberApplicationList(t);case 4:i=e.sent,this.memberApplicationList=i.memberApplicationList,this.total=i.total,e.next=13;break;case 9:e.prev=9,e.t0=e["catch"](1),this.$message({message:"获取会员申请列表失败",duration:2e3,type:"error"}),console.log(e.t0);case 13:case"end":return e.stop()}}),e,this,[[1,9]])})));function t(){return e.apply(this,arguments)}return t}(),handleRefresh:function(){var e=this.$message("刷新中");this.currentPage=1,this.inputKey="",this.getMemberApplicationList(),e.close()},handleSearch:function(){this.currentPage=1,this.getMemberApplicationList()},cancelDeny:function(){this.denyVisible=!1,this.$message({message:"操作已取消",duration:1500,type:"info"}),this.$refs["denyForm"].clearValidate()},handleDeny:function(e,t){this.denyVisible=!0,this.denyIndex=e,this.denyForm=JSON.parse(JSON.stringify(t)),this.isSendNotice=!0,this.noticeForm=s["a"].getNoticeTemplate(3)},saveDeny:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.denyVisible=!1,t={memberId:this.denyForm.memberId},e.prev=2,e.next=5,this.$api.user.denyMemberApplication(t);case 5:this.$message({message:"拒绝申请成功",duration:2e3,type:"success"}),this.memberApplicationList[this.denyIndex].memberType=3,this.isSendNotice&&setTimeout((function(){s["a"].sendNotice(i.denyForm.memberBindedUserId,3)}),1e3),e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](2),this.$message({message:"拒绝申请失败",duration:2e3,type:"error"}),console.log(e.t0);case 14:case 15:case"end":return e.stop()}}),e,this,[[2,10]])})));function t(){return e.apply(this,arguments)}return t}(),handlePass:function(e,t){this.passVisible=!0,this.passIndex=e,this.passForm=JSON.parse(JSON.stringify(t)),this.isSendNotice=!0,this.noticeForm=s["a"].getNoticeTemplate(2)},cancelPass:function(){this.passVisible=!1,this.$message({message:"操作已取消",duration:1500,type:"info"}),this.$refs["passForm"].clearValidate()},savePass:function(e){var t=this;this.$refs[e].validate(function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(i){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!i){e.next=18;break}return t.passVisible=!1,a={memberId:t.passForm.memberId,memberUid:t.passForm.memberUid,memberBindedUserId:t.passForm.memberBindedUserId},e.prev=3,e.next=6,t.$api.user.passMemberApplication(a);case 6:t.$message({message:"申请已通过",duration:2e3,type:"success"}),t.memberApplicationList[t.passIndex].memberType=2,t.isSendNotice&&setTimeout((function(){s["a"].sendNotice(t.passForm.memberBindedUserId,2)}),1e3),e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](3),t.$message({message:"通过申请失败",duration:2e3,type:"error"}),console.log(e.t0);case 15:e.next=20;break;case 18:return console.log("通过审核表单验证失败"),e.abrupt("return",!1);case 20:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(t){return e.apply(this,arguments)}}())},handlePageChange:function(e){this.currentPage=e,this.getMemberApplicationList()},handlePagePrev:function(){this.currentPage--},handlePageNext:function(){this.currentPage++}}},o=l,c=(i("b869"),i("0c7c")),m=Object(c["a"])(o,a,n,!1,null,"20aec3b5",null);t["default"]=m.exports},b869:function(e,t,i){"use strict";i("61f7")}}]);
//# sourceMappingURL=MemberApplication.a5ca0c67.js.map